<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.accountbook.project.mapper.WriteMapper">
    <delete id="deleteWriteTableRow" parameterType="java.lang.Integer">
        DELETE FROM AC_MONTH WHERE M_ID = #{m_id}
    </delete>

    <insert id="insertWriteTable" parameterType="Write">
        INSERT INTO AC_MONTH VALUES(MONTH_SEQ.NEXTVAL, #{a_id}, #{c_code}, TO_DATE(#{d_date},'YY/MM/DD'), #{m_amount}, #{m_memo})
    </insert>

    <insert id="checkDate" parameterType="Write">
        MERGE INTO AC_DATE
        USING DUAL ON(D_DATE = TO_DATE(#{d_date},'YY/MM/DD') AND M_ID = #{m_id})
        WHEN NOT MATCHED THEN INSERT(D_DATE, M_ID) VALUES(TO_DATE(#{d_date},'YY/MM/DD'), #{m_id})
    </insert>
</mapper>